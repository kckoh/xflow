# ============================================
# Jars Configuration
# ============================================
spark.jars                                          /opt/spark/jars/extra/iceberg-spark-runtime-3.5_2.12-1.4.3.jar
spark.driver.extraClassPath                         /opt/spark/jars/extra/*
spark.executor.extraClassPath                       /opt/spark/jars/extra/*

# ============================================
# Iceberg Catalog Configuration
# ============================================

# Iceberg catalog using Hive Metastore
spark.sql.catalog.iceberg                           org.apache.iceberg.spark.SparkCatalog
spark.sql.catalog.iceberg.type                      hive
spark.sql.catalog.iceberg.uri                       thrift://hive-metastore:9083
spark.sql.catalog.iceberg.warehouse                 s3a://warehouse/iceberg

# Iceberg S3 FileIO (for LocalStack)
spark.sql.catalog.iceberg.io-impl                   org.apache.iceberg.aws.s3.S3FileIO

# Iceberg Spark Extensions (for MERGE INTO support)
spark.sql.extensions                                org.apache.iceberg.spark.extensions.IcebergSparkSessionExtensions

# ============================================
# S3 Configuration (for LocalStack)
# ============================================
spark.hadoop.fs.s3a.endpoint                        http://localstack-main:4566
spark.hadoop.fs.s3a.access.key                      test
spark.hadoop.fs.s3a.secret.key                      test
spark.hadoop.fs.s3a.path.style.access               true
spark.hadoop.fs.s3a.impl                            org.apache.hadoop.fs.s3a.S3AFileSystem

# ============================================
# Hive Metastore Configuration
# ============================================
spark.sql.catalogImplementation                     hive
spark.hadoop.hive.metastore.uris                    thrift://hive-metastore:9083

# ============================================
# Performance Tuning
# ============================================
spark.sql.adaptive.enabled                          true
spark.sql.adaptive.coalescePartitions.enabled       true
